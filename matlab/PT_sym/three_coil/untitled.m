



clear
syms a1 a1g C1 L1 a1_d1 w1 Rn RL2 RL3
syms a2 a2g C2 L2 a2_d1 w2 M12 M13 k12 k13
syms a3 a3g C3 L3 a3_d1 w3

% 带入固有谐振频率
temp1 = 1/w1^2;
temp2 = 1/w2^2;
temp3 = 1/w3^2;

% q  dq/dt   d^2 q/dt^2的表达式
qc1_m = -1i*C1^0.5/2^0.5*(a1-a1g);
qc1_d1_m = (a1+a1g)/2^0.5/L1^0.5;
qc1_d2_m = 2^0.5/L1^0.5*(a1_d1-1i*(a1+a1g)*w1/2);

qc2_m = -1i*C2^0.5/2^0.5*(a2-a2g);
qc2_d1_m = (a2+a2g)/2^0.5/L2^0.5;
qc2_d2_m = 2^0.5/L2^0.5*(a2_d1-1i*(a2+a2g)*w2/2);

qc3_m = -1i*C3^0.5/2^0.5*(a3-a3g);
qc3_d1_m = (a3+a3g)/2^0.5/L3^0.5;
qc3_d2_m = 2^0.5/L3^0.5*(a3_d1-1i*(a3+a3g)*w3/2);

% eq3
eq1 = L1*qc1_d2_m + Rn*qc1_d1_m + qc1_m/C1 + M12*qc2_d2_m + M13*qc3_d2_m == 0;
eq2 = L2*qc2_d2_m + RL2*qc2_d1_m + qc2_m/C2 + M12*qc1_d2_m == 0;
eq3 = L3*qc3_d2_m + RL3*qc3_d1_m + qc3_m/C3 + M13*qc1_d2_m == 0;

[a1t, a2t, a3t] = solve(eq1,eq2,eq3,a1_d1,a2_d1,a3_d1);



% 带入变量
% a1t = simplify(subs(a1t, [L1*C1, L2*C2, L3*C3, M12/(L1*L2)^0.5, M13/(L1*L3)^0.5, a3g, a2g, a1g], [temp1, temp2, temp3, k12, k13, 0, 0, 0]));
% a1t = simplify(a1t, 'Steps', 10);
% a1t_res = collect(a1t, a1)
% pretty(a1t_res)

% a1_fenshi = (-(2^(1/2)*L1^(1/2)*L2^(1/2)*L3^(1/2)*((2^(1/2)*L2^(1/2)*L3^(1/2))/C1^(1/2) + 2^(1/2)*L1^(1/2)*L2^(1/2)*L3^(1/2)*w1 - (2^(1/2)*L3^(1/2)*M12^2*w1)/(L1^(1/2)*L2^(1/2)) - (2^(1/2)*L2^(1/2)*M13^2*w1)/(L1^(1/2)*L3^(1/2)) + (2^(1/2)*L2^(1/2)*L3^(1/2)*Rn*1i)/L1^(1/2))*1i)/(4*(L3*M12^2 + L2*M13^2 - L1*L2*L3)));
% a1_fenshi = subs(a1_fenshi, [M12^2, M13^2], [0, 0])
% [N,D]=numden(a1_fenshi)

% a1_fenshi = 2^(1/2)*L1^(1/2)*L2^(1/2)*L3^(1/2)*   ( 2^(1/2)*L3^(1/2)*M12*a2/(C2^(1/2)*L2^(1/2))  +    (2^(1/2)*L3^(1/2)*M12*RL2*a2*1i)/L2  )   /(4*(L3*M12^2 + L2*M13^2 - L1*L2*L3));
% a1_fenshi = subs(a1_fenshi, [M12^2, M13^2], [0, 0])
% [N,D]=numden(a1_fenshi)







a2t = simplify(subs(a2t, [L1*C1, L2*C2, L3*C3, M12/(L1*L2)^0.5, M13/(L1*L3)^0.5, a3g, a2g, a1g], [temp1, temp2, temp3, k12, k13, 0, 0, 0]));
a2t = simplify(a2t, 'Steps', 10);
a2t_res = collect(a2t, a1)
pretty(a2t_res)

% a2_fenshi = ((2^(1/2)*L1^(1/2)*L2^(1/2)*L3^(1/2)*((2^(1/2)*L1^(1/2)*L3^(1/2)*RL2)/L2^(1/2) - (2^(1/2)*L1^(1/2)*L3^(1/2)*1i)/C2^(1/2) - 2^(1/2)*L1^(1/2)*L2^(1/2)*L3^(1/2)*w2*1i + (2^(1/2)*M13^2*1i)/(C2^(1/2)*L1^(1/2)*L3^(1/2)) - (2^(1/2)*M13^2*RL2)/(L1^(1/2)*L2^(1/2)*L3^(1/2)) + (2^(1/2)*L3^(1/2)*M12^2*w2*1i)/(L1^(1/2)*L2^(1/2)) + (2^(1/2)*L2^(1/2)*M13^2*w2*1i)/(L1^(1/2)*L3^(1/2))))/(4*(L3*M12^2 + L2*M13^2 - L1*L2*L3)));
% a2_fenshi = subs(a2_fenshi, [M12^2, M13^2], [0, 0])
% [N,D]=numden(a2_fenshi)

% a2_fenshi = ((2^(1/2)*L1^(1/2)*L2^(1/2)*L3^(1/2)*(- (2^(1/2)*L3^(1/2)*M12*Rn)/L1 + (2^(1/2)*L3^(1/2)*M12*1i)/(C1^(1/2)*L1^(1/2))))/(4*(L3*M12^2 + L2*M13^2 - L1*L2*L3)));
% a2_fenshi = subs(a2_fenshi, [M12^2, M13^2], [0, 0])
% [N,D]=numden(a2_fenshi)

% a2_fenshi = ((2^(1/2)*L1^(1/2)*L2^(1/2)*L3^(1/2)*((2^(1/2)*M12*M13*RL3)/(L1^(1/2)*L3) - (2^(1/2)*M12*M13*1i)/(C3^(1/2)*L1^(1/2)*L3^(1/2))))/(4*(L3*M12^2 + L2*M13^2 - L1*L2*L3)));
% a2_fenshi = subs(a2_fenshi, [M12^2, M13^2], [0, 0])
% [N,D]=numden(a2_fenshi)







% a3t = simplify(subs(a3t, [L1*C1, L2*C2, L3*C3, M12/(L1*L2)^0.5, M13/(L1*L3)^0.5, a3g, a2g, a1g], [temp1, temp2, temp3, k12, k13, 0, 0, 0]));
% a3t = simplify(a3t, 'Steps', 10);
% a3t_res = collect(a3t, a2)
% pretty(a3t_res)

% a3_fenshi = ((2^(1/2)*L1^(1/2)*L2^(1/2)*L3^(1/2)*((2^(1/2)*M12^2)/(C3^(1/2)*L1^(1/2)*L2^(1/2)) - 2^(1/2)*L1^(1/2)*L2^(1/2)*L3^(1/2)*w3 - (2^(1/2)*L1^(1/2)*L2^(1/2))/C3^(1/2) + (2^(1/2)*L3^(1/2)*M12^2*w3)/(L1^(1/2)*L2^(1/2)) + (2^(1/2)*L2^(1/2)*M13^2*w3)/(L1^(1/2)*L3^(1/2)) - (2^(1/2)*L1^(1/2)*L2^(1/2)*RL3*1i)/L3^(1/2) + (2^(1/2)*M12^2*RL3*1i)/(L1^(1/2)*L2^(1/2)*L3^(1/2)))*1i)/(4*(L3*M12^2 + L2*M13^2 - L1*L2*L3)));
% a3_fenshi = subs(a3_fenshi, [M12^2, M13^2], [0, 0])
% [N,D]=numden(a3_fenshi)

% a3_fenshi = ((2^(1/2)*L1^(1/2)*L2^(1/2)*L3^(1/2)*((2^(1/2)*L2^(1/2)*M13)/(C1^(1/2)*L1^(1/2)) + (2^(1/2)*L2^(1/2)*M13*Rn*1i)/L1)*1i)/(4*(L3*M12^2 + L2*M13^2 - L1*L2*L3)));
% a3_fenshi = subs(a3_fenshi, [M12^2, M13^2], [0, 0])
% [N,D]=numden(a3_fenshi)

% a3_fenshi = (-(2^(1/2)*L1^(1/2)*L2^(1/2)*L3^(1/2)*((2^(1/2)*M12*M13)/(C2^(1/2)*L1^(1/2)*L2^(1/2)) + (2^(1/2)*M12*M13*RL2*1i)/(L1^(1/2)*L2))*1i)/(4*(L3*M12^2 + L2*M13^2 - L1*L2*L3)));
% a3_fenshi = subs(a3_fenshi, [M12^2, M13^2], [0, 0])
% [N,D]=numden(a3_fenshi)
